/*! For license information please see callback.js.LICENSE.txt */
!function(){var t={64583:function(t,e,r){var n=r(65606);t.exports=function(){"use strict";function t(t){return"function"==typeof t}var e=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},o=0,i=void 0,c=void 0,s=function(t,e){p[o]=t,p[o+1]=e,2===(o+=2)&&(c?c(d):b())};var u="undefined"!=typeof window?window:void 0,a=u||{},f=a.MutationObserver||a.WebKitMutationObserver,l="undefined"==typeof self&&void 0!==n&&"[object process]"==={}.toString.call(n),h="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function v(){var t=setTimeout;return function(){return t(d,1)}}var p=new Array(1e3);function d(){for(var t=0;t<o;t+=2)(0,p[t])(p[t+1]),p[t]=void 0,p[t+1]=void 0;o=0}var y,m,g,_,b=void 0;function w(t,e){var r=this,n=new this.constructor(S);void 0===n[O]&&I(n);var o=r._state;if(o){var i=arguments[o-1];s(function(){return M(o,n,i,r._result)})}else F(r,n,t,e);return n}function T(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(S);return k(e,t),e}b=l?function(){return n.nextTick(d)}:f?(m=0,g=new f(d),_=document.createTextNode(""),g.observe(_,{characterData:!0}),function(){_.data=m=++m%2}):h?((y=new MessageChannel).port1.onmessage=d,function(){return y.port2.postMessage(0)}):void 0===u?function(){try{var t=Function("return this")().require("vertx");return void 0!==(i=t.runOnLoop||t.runOnContext)?function(){i(d)}:v()}catch(t){return v()}}():v();var O=Math.random().toString(36).substring(2);function S(){}var A=void 0,j=1,E=2;function x(e,r,n){r.constructor===e.constructor&&n===w&&r.constructor.resolve===T?function(t,e){e._state===j?C(t,e._result):e._state===E?L(t,e._result):F(e,void 0,function(e){return k(t,e)},function(e){return L(t,e)})}(e,r):void 0===n?C(e,r):t(n)?function(t,e,r){s(function(t){var n=!1,o=function(t,e,r,n){try{t.call(e,r,n)}catch(t){return t}}(r,e,function(r){n||(n=!0,e!==r?k(t,r):C(t,r))},function(e){n||(n=!0,L(t,e))},t._label);!n&&o&&(n=!0,L(t,o))},t)}(e,r,n):C(e,r)}function k(t,e){if(t===e)L(t,new TypeError("You cannot resolve a promise with itself"));else if(o=typeof(n=e),null===n||"object"!==o&&"function"!==o)C(t,e);else{var r=void 0;try{r=e.then}catch(e){return void L(t,e)}x(t,e,r)}var n,o}function P(t){t._onerror&&t._onerror(t._result),G(t)}function C(t,e){t._state===A&&(t._result=e,t._state=j,0!==t._subscribers.length&&s(G,t))}function L(t,e){t._state===A&&(t._state=E,t._result=e,s(P,t))}function F(t,e,r,n){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+j]=r,o[i+E]=n,0===i&&t._state&&s(G,t)}function G(t){var e=t._subscribers,r=t._state;if(0!==e.length){for(var n=void 0,o=void 0,i=t._result,c=0;c<e.length;c+=3)n=e[c],o=e[c+r],n?M(r,n,o,i):o(i);t._subscribers.length=0}}function M(e,r,n,o){var i=t(n),c=void 0,s=void 0,u=!0;if(i){try{c=n(o)}catch(t){u=!1,s=t}if(r===c)return void L(r,new TypeError("A promises callback cannot return that same promise."))}else c=o;r._state!==A||(i&&u?k(r,c):!1===u?L(r,s):e===j?C(r,c):e===E&&L(r,c))}var N=0;function I(t){t[O]=N++,t._state=void 0,t._result=void 0,t._subscribers=[]}var R=function(){function t(t,r){this._instanceConstructor=t,this.promise=new t(S),this.promise[O]||I(this.promise),e(r)?(this.length=r.length,this._remaining=r.length,this._result=new Array(this.length),0===this.length?C(this.promise,this._result):(this.length=this.length||0,this._enumerate(r),0===this._remaining&&C(this.promise,this._result))):L(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;this._state===A&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var r=this._instanceConstructor,n=r.resolve;if(n===T){var o=void 0,i=void 0,c=!1;try{o=t.then}catch(t){c=!0,i=t}if(o===w&&t._state!==A)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(r===J){var s=new r(S);c?L(s,i):x(s,t,o),this._willSettleAt(s,e)}else this._willSettleAt(new r(function(e){return e(t)}),e)}else this._willSettleAt(n(t),e)},t.prototype._settledAt=function(t,e,r){var n=this.promise;n._state===A&&(this._remaining--,t===E?L(n,r):this._result[e]=r),0===this._remaining&&C(n,this._result)},t.prototype._willSettleAt=function(t,e){var r=this;F(t,void 0,function(t){return r._settledAt(j,e,t)},function(t){return r._settledAt(E,e,t)})},t}();var J=function(){function e(t){this[O]=N++,this._result=this._state=void 0,this._subscribers=[],S!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(t,e){try{e(function(e){k(t,e)},function(e){L(t,e)})}catch(e){L(t,e)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var r=this,n=r.constructor;return t(e)?r.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){throw t})}):r.then(e,e)},e}();return J.prototype.then=w,J.all=function(t){return new R(this,t).promise},J.race=function(t){var r=this;return e(t)?new r(function(e,n){for(var o=t.length,i=0;i<o;i++)r.resolve(t[i]).then(e,n)}):new r(function(t,e){return e(new TypeError("You must pass an array to race."))})},J.resolve=T,J.reject=function(t){var e=new this(S);return L(e,t),e},J._setScheduler=function(t){c=t},J._setAsap=function(t){s=t},J._asap=s,J.polyfill=function(){var t=void 0;if(void 0!==r.g)t=r.g;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=J},J.Promise=J,J}()},65606:function(t){var e,r,n=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function c(t){if(e===setTimeout)return setTimeout(t,0);if((e===o||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(r){try{return e.call(null,t,0)}catch(r){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:o}catch(t){e=o}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(t){r=i}}();var s,u=[],a=!1,f=-1;function l(){a&&s&&(a=!1,s.length?u=s.concat(u):f=-1,u.length&&h())}function h(){if(!a){var t=c(l);a=!0;for(var e=u.length;e;){for(s=u,u=[];++f<e;)s&&s[f].run();f=-1,e=u.length}s=null,a=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{return r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function v(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];u.push(new v(t,e)),1!==u.length||a||c(h)},v.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n].call(i.exports,i,i.exports,r),i.exports}r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),function(){"use strict";var t="https://confirmedservice.azurewebsites.net",e=("".concat("https://confirmedconnectservice.azurewebsites.net","/salesforce/record-email-as-task"),"".concat(t,"/api/invitations/meetings"),r(64583).Promise);function n(){var t,e,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",c=r.toStringTag||"@@toStringTag";function s(r,n,i,c){var s=n&&n.prototype instanceof a?n:a,f=Object.create(s.prototype);return o(f,"_invoke",function(r,n,o){var i,c,s,a=0,f=o||[],l=!1,h={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(e,r){return i=e,c=0,s=t,h.n=r,u}};function v(r,n){for(c=r,s=n,e=0;!l&&a&&!o&&e<f.length;e++){var o,i=f[e],v=h.p,p=i[2];r>3?(o=p===n)&&(s=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=v&&((o=r<2&&v<i[1])?(c=0,h.v=n,h.n=i[1]):v<p&&(o=r<3||i[0]>n||n>p)&&(i[4]=r,i[5]=n,h.n=p,c=0))}if(o||r>1)return u;throw l=!0,n}return function(o,f,p){if(a>1)throw TypeError("Generator is already running");for(l&&1===f&&v(f,p),c=f,s=p;(e=c<2?t:s)||!l;){i||(c?c<3?(c>1&&(h.n=-1),v(c,s)):h.n=s:h.v=s);try{if(a=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(l=h.n<0)?s:r.call(n,h))!==u)break}catch(e){i=t,c=1,s=e}finally{a=1}}return{value:e,done:l}}}(r,i,c),!0),f}var u={};function a(){}function f(){}function l(){}e=Object.getPrototypeOf;var h=[][i]?e(e([][i]())):(o(e={},i,function(){return this}),e),v=l.prototype=a.prototype=Object.create(h);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,o(t,c,"GeneratorFunction")),t.prototype=Object.create(v),t}return f.prototype=l,o(v,"constructor",l),o(l,"constructor",f),f.displayName="GeneratorFunction",o(l,c,"GeneratorFunction"),o(v),o(v,c,"Generator"),o(v,i,function(){return this}),o(v,"toString",function(){return"[object Generator]"}),(n=function(){return{w:s,m:p}})()}function o(t,e,r,n){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}o=function(t,e,r,n){function c(e,r){o(t,e,function(t){return this._invoke(e,r,t)})}e?i?i(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r:(c("next",0),c("throw",1),c("return",2))},o(t,e,r,n)}function i(t,r,n,o,i,c,s){try{var u=t[c](s),a=u.value}catch(t){return void n(t)}u.done?r(a):e.resolve(a).then(o,i)}var c=function(){var r,o=(r=n().m(function e(){var r,o,i,c,s,u,a,f,l,h,v,p;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=new URL(window.location.href),o=new URLSearchParams(r.search),i={},c=localStorage.getItem("verifier"),!(s=o.get("code"))){e.n=1;break}if(i.code=s,i.codeVerifier=c,u=localStorage.getItem("registrationForm"))try{i.registrationData=JSON.parse(u)}catch(t){console.error("Error parsing registration form data",t)}e.n=8;break;case 1:if(e.p=1,a=localStorage.getItem("confirmed_access_token")){e.n=2;break}return i.error="No access token found in localStorage",Office.onReady(function(){return Office.context.ui.messageParent(JSON.stringify(i))}),e.a(2);case 2:return f="".concat(t,"/api/account/GetSubscriberInfo"),e.n=3,fetch(f,{method:"GET",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}});case 3:if((l=e.v).ok){e.n=5;break}return e.n=4,l.text();case 4:return h=e.v,console.error("Error response:",h),i.error="API call failed: ".concat(l.status),Office.onReady(function(){return Office.context.ui.messageParent(JSON.stringify(i))}),e.a(2);case 5:return e.n=6,l.json();case 6:v=e.v,i.isSalesforceConnected=v.isSalesforceConnected||!1,i.subscriberInfo=v,e.n=8;break;case 7:e.p=7,p=e.v,console.error("Error in Salesforce callback:",p),i.error=p.message;case 8:Office.onReady(function(){return Office.context.ui.messageParent(JSON.stringify(i))});case 9:return e.a(2)}},e,null,[[1,7]])}),function(){var t=this,n=arguments;return new e(function(e,o){var c=r.apply(t,n);function s(t){i(c,e,o,s,u,"next",t)}function u(t){i(c,e,o,s,u,"throw",t)}s(void 0)})});return function(){return o.apply(this,arguments)}}();document.addEventListener("DOMContentLoaded",c)}()}();
//# sourceMappingURL=callback.js.map